<?php
require_once '../includes/config.php';
// –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Å–∏—Å—Ç–µ–º–∏
require_once '../includes/db.php';
// –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –º–æ–¥—É–ª—è –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
require_once '../includes/auth.php';
// –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –º–æ–¥—É–ª—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

if (!isLoggedIn()) {
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π
    header('Location: login.php');
    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É
    exit();
    // –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
}

$conn = getDbConnection();
// –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
$user_id = $_SESSION['user_id'];
// –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Å–µ—Å—ñ—ó

// –û—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
$sql = "SELECT name FROM users WHERE id = '$user_id'";
$result = $conn->query($sql);
// –ó–∞–ø–∏—Ç –¥–æ –±–∞–∑–∏ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
$user_name = $result->fetch_assoc()['name'] ?? '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á';
// –û—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ –∞–±–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

$conn->close();
// –ó–∞–∫—Ä–∏—Ç—Ç—è –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
?>

<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <!-- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ -->
    <title>Vinc_Road - –ó–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫</title>
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ -->
    <link rel="stylesheet" href="../css/common.css">
    <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö —Å—Ç–∏–ª—ñ–≤ -->
    <link rel="stylesheet" href="../css/feedback.css">
    <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ –¥–ª—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤‚Äô—è–∑–∫—É -->
    <link rel="stylesheet" href="../css/responsive.css">
    <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω—É -->
</head>
<body>
    <button id="theme-toggle" class="theme-toggle">üåô</button>
    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–µ–º–∏ -->
    <header>
        <h1>Vinc_Road: –ó–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫</h1>
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ -->
        <nav>
            <a href="index.php">–ì–æ–ª–æ–≤–Ω–∞</a>
            <a href="monitor.php">–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥</a>
            <a href="analytics.php">–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞</a>
            <a href="report.php">–ü–æ–≤—ñ–¥–æ–º–∏—Ç–∏ –ø—Ä–æ –ø—Ä–æ–±–ª–µ–º—É</a>
            <a href="about.php">–ü—Ä–æ –Ω–∞—Å</a>
            <a href="profile.php">–ü—Ä–æ—Ñ—ñ–ª—å</a>
            <a href="logout.php">–í–∏–π—Ç–∏</a>
            <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω–µ –º–µ–Ω—é -->
        </nav>
    </header>
    <main>
        <section class="chat-section">
            <h2>–ß–∞—Ç –∑ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—î—é</h2>
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü—ñ—ó —á–∞—Ç—É -->
            <p>–ù–∞–ø–∏—à—ñ—Ç—å –Ω–∞–º, —ñ –Ω–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å –≤–∞–º —è–∫–æ–º–æ–≥–∞ —à–≤–∏–¥—à–µ!</p>
            <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∏–π —Ç–µ–∫—Å—Ç -->
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages"></div>
                <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —á–∞—Ç—É -->
                <div class="chat-input">
                    <textarea id="chat-message" rows="4" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..." required></textarea>
                    <!-- –ü–æ–ª–µ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è -->
                    <button id="send-message" class="btn send-btn">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
                    <!-- –ö–Ω–æ–ø–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è -->
                </div>
            </div>
        </section>
    </main>
    <footer>
        <p>¬© 2025 Vinc_Road - –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –£–∫—Ä–∞—ó–Ω–∏</p>
        <!-- –ù–∏–∂–Ω—ñ–π –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª -->
    </footer>
    <script src="../js/theme.js"></script>
    <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—É –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–µ–º–∏ -->
    <script src="../js/chat.js"></script>
    <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—É –¥–ª—è —Ä–æ–±–æ—Ç–∏ —á–∞—Ç—É -->
    <script>
        // –ü–µ—Ä–µ–¥–∞—á–∞ user_id —ñ user_name –¥–ª—è chat.js
        const currentUser = {
            id: <?php echo json_encode($user_id); ?>,
            name: <?php echo json_encode($user_name); ?>
        };
        // –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è —á–∞—Ç—É
        // –ü–æ–∑–Ω–∞—á–∫–∞ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –ø—ñ—Å–ª—è –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—è
        sessionStorage.setItem('feedbackMessagesRead', 'true');
        // –ü–æ–∑–Ω–∞—á–∫–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
    </script>
</body>
</html>